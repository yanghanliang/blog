webpackJsonp([17],{Quw4:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("mvHQ"),a=r.n(s),o=r("Xxa5"),n=r.n(o),i=r("exGp"),c=r.n(i),m={name:"login",data:function(){var e,t=this,r=(e=c()(n.a.mark(function e(r,s,a){var o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=17;break}if("login"!==t.activeName){e.next=4;break}return a(),e.abrupt("return",!1);case 4:return e.prev=4,e.next=7,t.$http.get("user/userNameValidation?userName="+s);case 7:o=e.sent,o.data.status?a():a(new Error("此用户名已被使用，请重新设置用户名")),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),a(new Error("请重试"));case 15:e.next=18;break;case 17:a(new Error("请输入用户名"));case 18:case"end":return e.stop()}},e,t,[[4,12]])})),function(t,r,s){return e.apply(this,arguments)});return{form:{alias:"",username:"",password:"",confirmPassword:""},activeName:this.$route.name,rules:{name:[{trigger:"change",message:"请输入用户名",required:!0}],username:[{validator:r,trigger:"change",required:!0}],password:[{trigger:"change",message:"请输入密码",required:!0}],confirmPassword:[{validator:function(e,r,s){if(!r)return s(new Error("请输入密码"));r===t.form.password?s():s(new Error("两次密码不一致"))},trigger:"change",required:!0}]},currentTimer:null,type:{password:"text",confirmPassword:"text"},lock:!0}},created:function(){this.meteorShower()},beforeDestroy:function(){clearInterval(this.currentTimer)},methods:{login:function(){var e=this;return c()(n.a.mark(function t(){var r,s,o;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.Global.verification(e,"form");case 2:if(t.sent){t.next=5;break}return t.abrupt("return",!1);case 5:return r={username:e.form.username,password:e.form.password},t.next=8,e.$http.post("login",r);case 8:s=t.sent,200===(o=s.data).status?(e.$message({type:"success",message:o.msg,center:!0}),localStorage.setItem("token",o.token),localStorage.setItem("user",a()(o.user)),e.__proto__._jurisdiction=o.notJurisdiction,window.localStorage.setItem("_jurisdiction",a()(o.notJurisdiction)),e.$router.go(-1)):e.$message({type:"error",message:o.msg,center:!0});case 11:case"end":return t.stop()}},t,e)}))()},meteorShower:function(e){var t={eachStep:5,eachTime:30,st:{max:200,min:0},sl:{max:window.screen.width,min:300},et:{max:-400,min:0},el:{max:1100,min:300},meteorNumber:{max:5,min:2,time:1e3}};for(var r in e)t[r]=e[r];function s(e,t){return Math.floor(Math.random()*(e-t+1)+t)}var a=document.getElementsByTagName("body")[0],o=function(){if(!1!==document.hidden)return!1;setTimeout(function(){!function(){var e=document.createElement("div");e.className="meteor",a.appendChild(e);var r=s(t.st.max,t.st.min),o=s(t.sl.max,t.sl.min),n=s(t.et.max,t.et.min),i=(s(t.el.max,t.el.min),Math.abs(n-r)/t.eachStep),c=.6*i,m=0,l=1/c,u=1/(.4*i),f=0;e.style.top=r+"px",e.style.left=o+"px";!function(s,a){var o=setInterval(function(){++m<c?(f+=l,e.style.opacity=f):(f-=u,e.style.opacity=f),s<r?r-=t.eachStep:(clearInterval(o),e.remove()),e.style.transform=" rotate(-45deg) translate3d("+r+"px, 3px, 0)"},t.eachTime)}(n)}()},10*Math.random())};this.currentTimer=setInterval(o,t.meteorNumber.time),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState?this.currentTimer=setInterval(o,t.meteorNumber.time):clearInterval(this.currentTimer)})},register:function(){var e=this;return c()(n.a.mark(function t(){var r,s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.Global.verification(e,"form");case 2:if(!t.sent){t.next=16;break}return r={alias:e.form.alias,userName:e.form.username,password:e.form.password},t.prev=5,t.next=8,e.$http.post("user/addUser",r);case 8:s=t.sent,200===s.data.status&&(e.$message.success("注册成功,请登录~"),location.reload()),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),console.log(t.t0);case 16:case"end":return t.stop()}},t,e,[[5,13]])}))()},resetForm:function(){this.form.username="",this.form.password="",this.form.confirmPassword="",this.$refs.form.resetFields()},passwordFocus:function(){var e=this;0===String(this.form.password).length&&this.lock&&(this.$refs.password.blur(),this.lock=!1,setTimeout(function(){e.type.password="text",e.$refs.password.focus(),e.lock=!0}))},confirmPasswordFocus:function(){var e=this;0===String(this.form.confirmPassword).length&&this.lock&&(this.$refs.confirmPassword.blur(),this.lock=!1,setTimeout(function(){e.type.confirmPassword="text",e.$refs.confirmPassword.focus(),e.lock=!0}))}},watch:{"form.password":function(e,t){var r=this;if("login"===this.activeName)return!1;String(e).length>0?setTimeout(function(){r.type.password="password"}):this.$refs.password&&(this.$refs.password.blur(),this.lock=!1,setTimeout(function(){r.type.password="text",r.$refs.password.focus(),r.lock=!0}))},"form.confirmPassword":function(e){var t=this;if("login"===this.activeName)return!1;String(e).length>0?setTimeout(function(){t.type.confirmPassword="password"}):this.$refs.confirmPassword&&(this.$refs.confirmPassword.blur(),this.lock=!1,setTimeout(function(){t.type.confirmPassword="text",t.$refs.confirmPassword.focus(),t.lock=!0}))}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login"},[r("el-form",{ref:"form",staticClass:"login-form",attrs:{rules:e.rules,"label-position":"top",model:e.form,"label-width":"80px","hide-required-asterisk":!0},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-tabs",{on:{"tab-click":e.resetForm},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"用户登录",name:"login"}}),e._v(" "),r("el-tab-pane",{attrs:{label:"用户注册",name:"register"}}),e._v(" "),"login"===e.activeName?[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"box-show-inster",attrs:{maxlength:"20"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[r("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.form.username.length)+"/20")])])],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{staticClass:"box-show-inster",attrs:{type:"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),r("el-form-item",[r("el-button",{staticClass:"btn-login",attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")])],1)]:[r("el-form-item",{key:"username",attrs:{label:"用户名",prop:"username"}},[r("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{type:"text",autocomplete:"off",maxlength:"20"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[r("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.form.username.length)+"/20")])])],1),e._v(" "),r("el-form-item",{key:"alias",attrs:{label:"昵称"}},[r("el-input",{attrs:{type:"text",maxlength:"20"},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}},[r("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.form.alias.length)+"/20")])])],1),e._v(" "),r("el-form-item",{key:"password",attrs:{label:"密码",prop:"password"}},[r("el-input",{ref:"password",attrs:{type:e.type.password,autocomplete:"off"},on:{focus:e.passwordFocus},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e._v(" "),r("input",{staticStyle:{display:"none"},attrs:{type:"password",autocomplete:"new-password"}})],1),e._v(" "),r("el-form-item",{key:"passwords",attrs:{label:"确认密码",autocomplete:"off",prop:"confirmPassword"}},[r("el-input",{ref:"confirmPassword",attrs:{type:e.type.confirmPassword},on:{focus:e.confirmPasswordFocus},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register.apply(null,arguments)}},model:{value:e.form.confirmPassword,callback:function(t){e.$set(e.form,"confirmPassword",t)},expression:"form.confirmPassword"}})],1),e._v(" "),r("el-form-item",[r("el-button",{staticClass:"btn-login",attrs:{type:"primary"},on:{click:e.register}},[e._v("注册")])],1)]],2)],1)],1)},staticRenderFns:[]};var u=r("VU/8")(m,l,!1,function(e){r("xMbD"),r("tXmE")},"data-v-13708357",null);t.default=u.exports},tXmE:function(e,t){},xMbD:function(e,t){}});